name: cms-ars-5.0-red-hat-enterprise-linux-7-stig-overlay
title: cms-ars-5.0-red-hat-enterprise-linux-7-stig-overlay
maintainer: CMS SAF team
copyright: .
copyright_email: saf@cms.hhs.gov
license: Apache-2.0
summary: "CMS ARS 5.0 Overlay InSpec Validation Profile for RHEL7 STIG"
version: 1.3.1
inspec_version: ">= 4.0"

depends:
- name: redhat-enterprise-linux-7-stig-baseline
  url: https://github.com/mitre/redhat-enterprise-linux-7-stig-baseline/archive/main.tar.gz

inputs:
  - name: system_categorization
    desc: "Selected system baseline based on the environment variable"
    type: String
    value: <%= ENV['BASELINE'].nil? ? 'Moderate (Default)' : ENV['BASELINE'] %>

  - name: org_name 
    desc: "Name of the organization running this profile"
    type: String
    value: "CMS"
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: storage_volume
    desc: Amount of audit storage volume
    type: Numeric
    <% if ENV['BASELINE'] == 'High' || ENV['BASELINE'] == 'High-HVA' %>
    value: 80
    <% end %>
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: storage_space_left
    desc: Amount of audit storage volume left
    type: Numeric
    <% if ENV['BASELINE'] == 'High' || ENV['BASELINE'] == 'High-HVA' %>
    value: 20
    <% end %>
    profile: redhat-enterprise-linux-7-stig-baseline 

  - name: unsuccessful_attempts
    desc: Maximum number of unsuccessful attempts before lockout
    type: Numeric
    <% if ENV['BASELINE'] == 'Moderate' || ENV['BASELINE'] == 'Moderate-HVA' || ENV['BASELINE'] == 'Low' || ENV['BASELINE'] == 'Low-HVA' || ENV['BASELINE'].nil? %>
    value: 5
    <% else %>
    value: 3
    <% end %>
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: days_of_inactivity
    desc: Maximum number of days if account inactivity before account lockout
    type: Numeric
    <% if ENV['BASELINE'] == 'High-HVA' || ENV['BASELINE'] == 'High' %>
    value: 30
    <% elsif ENV['BASELINE'].nil? || ENV['BASELINE'] == 'Moderate' || ENV['BASELINE'] == 'Moderate-HVA' %>
    value: 60
    <% end %>
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: system_inactivity_timeout
    desc: Maximum system inactivity timeout (time in seconds).
    type: Numeric
    value: 900 ## should be 30 mins for h & m
    profile: redhat-enterprise-linux-7-stig-baseline 

  - name: client_alive_interval 
    desc: Interval of network connections associated with SSH 
    type: Numeric
    value: 1800 ## should be 30 mins for h & m
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: maxlogins_limit
    desc: Amount of max logins allowed
    type: String
    <% if ENV['BASELINE'] == 'High-HVA' || ENV['BASELINE'] == 'High' %>
    value: '1'
    <% end %>
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: banner_message_text_gui
    description: The banner message text for GUI logins.
    type: string
    value: "* This warning banner provides privacy and security notices consistent with applicable federal laws, directives, and other federal guidance for accessing this Government system, which includes (1) this computer network, (2) all computers connected to this network, and (3) all devices and storage media attached to this network or to a computer on this network.
  * This system is provided for Government authorized use only.
  * Unauthorized or improper use of this system is prohibited and may result in disciplinary action and/or civil and criminal penalties.
  * Personal use of social media and networking sites on this system is limited as to not interfere with official work duties and is subject to monitoring.
  * By using this system, you understand and consent to the following:
  - The Government may monitor, record, and audit your system usage, including usage of personal devices and email systems for official duties or to conduct HHS business. Therefore, you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this system. At any time, and for any lawful Government purpose, the government may monitor, intercept, and search and seize any communication or data transiting or stored on this system.
  - Any communication or data transiting or stored on this system may be disclosed or used for any lawful Government purpose"
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: banner_message_text_cli
    description: The bannermessage text for command line interface logins.
    type: string
    value: "* This warning banner provides privacy and security notices consistent with applicable federal laws, directives, and other federal guidance for accessing this Government system, which includes (1) this computer network, (2) all computers connected to this network, and (3) all devices and storage media attached to this network or to a computer on this network.
  * This system is provided for Government authorized use only.
  * Unauthorized or improper use of this system is prohibited and may result in disciplinary action and/or civil and criminal penalties.
  * Personal use of social media and networking sites on this system is limited as to not interfere with official work duties and is subject to monitoring.
  * By using this system, you understand and consent to the following:
  - The Government may monitor, record, and audit your system usage, including usage of personal devices and email systems for official duties or to conduct HHS business. Therefore, you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this system. At any time, and for any lawful Government purpose, the government may monitor, intercept, and search and seize any communication or data transiting or stored on this system.
  - Any communication or data transiting or stored on this system may be disclosed or used for any lawful Government purpose"
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: banner_message_text_ral
    description: The banner message text for remote access logins.
    type: string
    value: "* This warning banner provides privacy and security notices consistent with applicable federal laws, directives, and other federal guidance for accessing this Government system, which includes (1) this computer network, (2) all computers connected to this network, and (3) all devices and storage media attached to this network or to a computer on this network.
  * This system is provided for Government authorized use only.
  * Unauthorized or improper use of this system is prohibited and may result in disciplinary action and/or civil and criminal penalties.
  * Personal use of social media and networking sites on this system is limited as to not interfere with official work duties and is subject to monitoring.
  * By using this system, you understand and consent to the following:
  - The Government may monitor, record, and audit your system usage, including usage of personal devices and email systems for official duties or to conduct HHS business. Therefore, you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this system. At any time, and for any lawful Government purpose, the government may monitor, intercept, and search and seize any communication or data transiting or stored on this system.
  - Any communication or data transiting or stored on this system may be disclosed or used for any lawful Government purpose"
    profile: redhat-enterprise-linux-7-stig-baseline

  - name: overlay_controls
    desc: 'List of inapplicable controls in ARS 5.0 based on the system categorization'
    type: Array
    <% if ENV['BASELINE'] == 'High-HVA' %>
    value: []
    <% elsif ENV['BASELINE'] == 'High' %>
    value: []
    <% elsif ENV['BASELINE'] == 'Moderate-HVA' %>
    value: 
      - "SV-204513" # AU-5 (1)
      - "SV-204514" # AU-5 (1)
      - "SV-204515" # AU-5 (1)
      - "SV-204576" # AC-10
      - "SV-251705" # SI-6
    <% elsif ENV['BASELINE'] == 'Moderate' || ENV['BASELINE'].nil? %> # Default
    value: 
      - "SV-204513" # AU-5 (1)
      - "SV-204514" # AU-5 (1)
      - "SV-204515" # AU-5 (1)
      - "SV-204576" # AC-10
      - "SV-251705" # SI-6
    <% elsif ENV['BASELINE'] == 'Low-HVA' %>
    value: 
      - "SV-204396" # AC-11  
      - "SV-204398" # AC-11
      - "SV-204399" # AC-11
      - "SV-204400" # AC-11
      - "SV-204402" # AC-11
      - "SV-204403" # AC-11
      - "SV-204404" # AC-11
      - "SV-204450" # IA-3 
      - "SV-204486" # CM-7 (2)
      - "SV-204513" # AU-5 (1) 
      - "SV-204514" # AU-5 (1) 
      - "SV-204515" # AU-5 (1) 
      - "SV-204516" # AC-10 
      - "SV-204576" # AC-10 
      - "SV-204579" # SC-10, AC-12
      - "SV-204581" # AC-17 (2)
      - "SV-204582" # AC-17 (2)
      - "SV-204583" # AC-17 (2)
      - "SV-204587" # SC-10, AC-12
      - "SV-204589" # SC-10, AC-12
      - "SV-204595" # AC-17 (2)
      - "SV-204634" # AC-18 (1), AC-18 (1), SC-8
      - "SV-214800" # SI-4 (5)
      - "SV-214937" # AC-11
      - "SV-237634" # AC-6 (5)
      - "SV-251705" # SI-6
      - "SV-254523" # AC-2 (2)
      - "SV-255926" # AC-11
      - "SV-255927" # SC-4
    <% elsif ENV['BASELINE'] == 'Low' %> 
    value: 
      - "SV-204396" # AC-11  
      - "SV-204398" # AC-11
      - "SV-204399" # AC-11
      - "SV-204400" # AC-11
      - "SV-204402" # AC-11
      - "SV-204403" # AC-11
      - "SV-204404" # AC-11
      - "SV-204450" # IA-3 
      - "SV-204486" # CM-7 (2)
      - "SV-204513" # AU-5 (1) 
      - "SV-204514" # AU-5 (1) 
      - "SV-204515" # AU-5 (1) 
      - "SV-204516" # AC-10 
      - "SV-204576" # AC-10 
      - "SV-204579" # SC-10, AC-12
      - "SV-204581" # AC-17 (2)
      - "SV-204582" # AC-17 (2)
      - "SV-204583" # AC-17 (2)
      - "SV-204587" # SC-10, AC-12
      - "SV-204589" # SC-10, AC-12
      - "SV-204595" # AC-17 (2)
      - "SV-204634" # AC-18 (1), AC-18 (1), SC-8
      - "SV-214800" # SI-4 (5)
      - "SV-214937" # AC-11 
      - "SV-237634" # AC-6 (5)
      - "SV-251705" # SI-6
      - "SV-254523" # AC-2 (2)
      - "SV-255926" # AC-11
      - "SV-255927" # SC-4
    <% end %>

